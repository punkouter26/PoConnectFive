@page "/"
@using PoConnectFive.Shared.Models
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime

<PageTitle>Connect Five - Welcome</PageTitle>

<RadzenStack AlignItems="AlignItems.Center" Gap="3rem" Class="rz-p-4">
    <RadzenStack AlignItems="AlignItems.Center" Gap="0">
        <RadzenText Text="Connect Five" TextStyle="TextStyle.H1" TagName="TagName.H1" Style="color: var(--rz-primary);" />
        <RadzenText Text="A strategic game of alignment and tactics" TextStyle="TextStyle.Subtitle1" TagName="TagName.P" />
    </RadzenStack>

    <RadzenRow Gap="2rem" JustifyContent="JustifyContent.Center">
        <RadzenColumn Size="12" SizeMD="5">
            <RadzenCard Style="height: 100%;">
                <RadzenStack AlignItems="AlignItems.Center" Gap="1rem">
                    <RadzenText Text="ðŸ¤–" Style="font-size: 3rem;" />
                    <RadzenText Text="Single Player" TextStyle="TextStyle.H5" TagName="TagName.H2" />
                    <RadzenText Text="Challenge our adaptive AI" TextStyle="TextStyle.Body1" TagName="TagName.P" TextAlign="TextAlign.Center" />
                    
                    <RadzenStack Orientation="Orientation.Vertical" Gap="0.5rem" AlignItems="AlignItems.Stretch" Style="width: 100%;">
                        @foreach (var difficulty in Enum.GetValues<AIDifficulty>())
                        {
                            var difficultyName = difficulty.ToString();
                            <RadzenButton Click="() => StartGameWithDifficulty(difficulty)" 
                                          Text="@difficultyName" 
                                          Style="width: 100%;"
                                          ButtonStyle="ButtonStyle.Secondary" 
                                          Shade="Shade.Lighter">
                                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                                     <RadzenText Text="@(difficulty switch {
                                            AIDifficulty.Easy => "ðŸ˜Š",
                                            AIDifficulty.Medium => "ðŸ¤”",
                                            AIDifficulty.Hard => "ðŸ¤¯",
                                            _ => "ðŸ¤–"
                                        })" Style="font-size: 1.5rem;" />
                                    <RadzenStack Gap="0">
                                        <RadzenText Text="@difficultyName" />
                                        <RadzenText Text="@(difficulty switch {
                                                AIDifficulty.Easy => "Perfect for beginners",
                                                AIDifficulty.Medium => "For experienced players",
                                                AIDifficulty.Hard => "Test your mastery",
                                                _ => ""
                                            })" TextStyle="TextStyle.Caption" />
                                    </RadzenStack>
                                </RadzenStack>
                            </RadzenButton>
                        }
                    </RadzenStack>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeMD="5">
             <RadzenCard Style="height: 100%; cursor: pointer;" Click="() => StartTwoPlayer()"> @* Corrected click handler syntax *@
                 <RadzenStack AlignItems="AlignItems.Center" Gap="1rem">
                    <RadzenText Text="ðŸ‘¥" Style="font-size: 3rem;" />
                    <RadzenText Text="Two Players" TextStyle="TextStyle.H5" TagName="TagName.H2" />
                    <RadzenText Text="Play against a friend on the same device" TextStyle="TextStyle.Body1" TagName="TagName.P" TextAlign="TextAlign.Center" />
                 </RadzenStack>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>

    <RadzenStack Orientation="Orientation.Horizontal" Gap="1rem" JustifyContent="JustifyContent.Center">
        <RadzenButton Click="ViewLeaderboard" Text="Leaderboard" Icon="leaderboard" ButtonStyle="ButtonStyle.Secondary" />
        @* Settings button removed previously *@
    </RadzenStack>
</RadzenStack>


@code {
    // Removed _showDifficulties as buttons are always visible now
    // Removed duplicate ShowDifficultyOptions method

    private void StartGameWithDifficulty(AIDifficulty difficulty) // Changed to void
    {
        var queryParams = System.Web.HttpUtility.ParseQueryString(string.Empty);
        queryParams["mode"] = "single";
        queryParams["difficulty"] = difficulty.ToString();
        NavigationManager.NavigateTo($"/game?{queryParams}");
    }

    private void StartTwoPlayer()
    {
        var queryParams = System.Web.HttpUtility.ParseQueryString(string.Empty);
        queryParams["mode"] = "two-player";
        NavigationManager.NavigateTo($"/game?{queryParams}");
    }

    private void ViewLeaderboard()
    {
        NavigationManager.NavigateTo("/leaderboard");
    }
}

<style>
    .welcome-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        text-align: center;
    }

    .welcome-header {
        margin-bottom: 3rem;
    }

    .welcome-header h1 {
        font-size: 3rem;
        color: #2196F3;
        margin-bottom: 0.5rem;
        animation: fadeInDown 0.8s ease-out;
    }

    .subtitle {
        font-size: 1.2rem;
        color: #666;
        animation: fadeInUp 0.8s ease-out;
    }

    .game-modes {
        display: flex;
        gap: 2rem;
        justify-content: center;
        margin-bottom: 2rem;
        animation: fadeIn 1s ease-out;
    }

    .mode-card {
        background: white;
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        width: 300px;
        position: relative;
    }

    .mode-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .mode-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }

    .mode-card h2 {
        color: #2196F3;
        margin-bottom: 1rem;
    }

    .mode-card p {
        color: #666;
    }

    .difficulty-options {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border-radius: 0 0 8px 8px;
        padding: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 10;
    }

    .difficulty-btn {
        display: flex;
        align-items: center;
        width: 100%;
        padding: 1rem;
        margin: 0.5rem 0;
        border: none;
        background: #f5f5f5;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .difficulty-btn:hover {
        background: #e3f2fd;
    }

    .difficulty-btn.easy {
        border-left: 4px solid #4CAF50;
    }

    .difficulty-btn.medium {
        border-left: 4px solid #FFC107;
    }

    .difficulty-btn.hard {
        border-left: 4px solid #f44336;
    }

    .difficulty-icon {
        font-size: 1.5rem;
        margin-right: 1rem;
    }

    .difficulty-info {
        text-align: left;
    }

    .difficulty-name {
        display: block;
        font-weight: bold;
        color: #333;
    }

    .difficulty-desc {
        display: block;
        font-size: 0.8rem;
        color: #666;
    }

    .additional-options {
        display: flex;
        gap: 1rem;
        justify-content: center;
        animation: fadeInUp 1.2s ease-out;
    }

    .btn-secondary {
        padding: 0.75rem 1.5rem;
        border: 2px solid #2196F3;
        background: transparent;
        color: #2196F3;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-secondary:hover {
        background: #2196F3;
        color: white;
    }

    .btn-icon {
        font-size: 1.2rem;
    }

    .tutorial-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease-out;
    }

    .tutorial-content {
        background: white;
        padding: 2rem;
        border-radius: 8px;
        max-width: 500px;
        width: 90%;
        animation: scaleIn 0.3s ease-out;
    }

    .tutorial-steps {
        margin: 2rem 0;
    }

    .tutorial-step {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin: 1rem 0;
        text-align: left;
    }

    .step-number {
        width: 30px;
        height: 30px;
        background: #2196F3;
        color: white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
    }

    .btn-primary {
        padding: 0.75rem 1.5rem;
        background: #2196F3;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .btn-primary:hover {
        background: #1976D2;
    }
</style>
